!function(e){function t(t){for(var o,c,a=t[0],s=t[1],l=t[2],u=0,d=[];u<a.length;u++)c=a[u],r[c]&&d.push(r[c][0]),r[c]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);for(p&&p(t);d.length;)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,a=1;a<n.length;a++){var s=n[a];0!==r[s]&&(o=!1)}o&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},r={0:0},i=[];function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="http://localhost:3000/";var a=window.webpackJsonp=window.webpackJsonp||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var p=s;i.push([248,1]),n()}({246:function(e,t,n){var o=n(585);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},248:function(e,t,n){n(249),e.exports=n(591)},52:function(e,t,n){var o=n(549);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},530:function(e,t,n){var o=n(531);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},531:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.Block__shadow_2-4hx, .Block__base_3ulp8 {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.Block__base_3ulp8 {\n  font-size: 12px;\n  color: #d4d4d4;\n  border: 1px solid #2b2b2b;\n  background-color: #1e1e1e;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  width: 200px;\n  display: flex;\n  flex-direction: column; }\n  .Block__base_3ulp8 button {\n    display: inline-block;\n    text-decoration: none;\n    color: inherit;\n    border: none;\n    font: inherit;\n    padding: 1px 8px;\n    outline: none;\n    cursor: pointer;\n    background-color: #2b2b2b;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    margin: 0; }\n    .Block__base_3ulp8 button:not(:first-of-type) {\n      margin-left: 1px; }\n  .Block__base_3ulp8 textarea {\n    width: 100%;\n    border: none;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: vertical;\n    outline: none;\n    display: block;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    border-radius: 0; }\n\n.Block__textarea-div_19vCU {\n  height: calc(100% - 16px);\n  padding: 5px;\n  box-sizing: border-box; }\n\n.Block__red_1kUYK {\n  background-color: #f44336 !important; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",shadow:"Block__shadow_2-4hx",base:"Block__base_3ulp8","textarea-div":"Block__textarea-div_19vCU",red:"Block__red_1kUYK"}},549:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px"}},550:function(e,t,n){var o=n(551);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},551:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,'.BlockCreator__shadow_Y8igC, .BlockCreator__base_1ZSFp {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.BlockCreator__base_1ZSFp {\n  background-color: #1e1e1e;\n  border: 1px solid #2b2b2b;\n  color: #d4d4d4;\n  width: 200px;\n  padding: 10px;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  font-size: 12px; }\n  .BlockCreator__base_1ZSFp select {\n    display: block;\n    background-color: #2b2b2b;\n    color: inherit;\n    width: 100%;\n    border: 1px solid transparent;\n    margin-bottom: 5px;\n    font: inherit;\n    outline: none;\n    -webkit-appearance: none;\n    padding: 2px 4px; }\n    .BlockCreator__base_1ZSFp select:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp textarea {\n    width: 100%;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: vertical;\n    outline: none;\n    display: block;\n    margin-bottom: 5px;\n    border: 1px solid transparent;\n    border-radius: 0; }\n    .BlockCreator__base_1ZSFp textarea:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp button {\n    display: inline-block;\n    background-color: #2b2b2b;\n    color: inherit;\n    border-radius: 4px;\n    font: inherit;\n    border: none;\n    outline: none;\n    cursor: pointer; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",shadow:"BlockCreator__shadow_Y8igC",base:"BlockCreator__base_1ZSFp"}},563:function(e,t,n){var o=n(564);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},564:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".Chain__base_L0Lag {\n  background-color: #1e1e1e;\n  position: relative;\n  width: 100%;\n  height: 100%; }\n  .Chain__base_L0Lag > svg {\n    display: block;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0;\n    top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",base:"Chain__base_L0Lag"}},568:function(e,t,n){var o=n(569);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},569:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,".HTMLRenderer__base_y4ZXu {\n  display: block;\n  width: 100%;\n  height: 100%;\n  border: none;\n  background-color: white;\n  position: absolute;\n  left: 0;\n  top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",base:"HTMLRenderer__base_y4ZXu"}},585:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"body {\n  box-sizing: border-box; }\n\n.App__wrap_1SQHV {\n  width: 100%;\n  height: 100%;\n  background-color: #1e1e1e; }\n  .App__wrap_1SQHV footer {\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    border-top: 1px solid #2b2b2b;\n    color: #d4d4d4;\n    background-color: #1e1e1e; }\n\n.App__base_2Rw2G {\n  width: 100%;\n  height: calc(100% - 36px); }\n\n.App__link_36M0v {\n  font-weight: 100;\n  padding: 5px 10px;\n  color: #555555;\n  display: inline-block;\n  text-decoration: none; }\n  .App__link_36M0v > span {\n    padding: 3px 6px;\n    display: inline-block;\n    border-bottom: 1px transparent solid; }\n\n.App__active_3QbdL {\n  color: #d4d4d4; }\n  .App__active_3QbdL > span {\n    border-bottom-color: #007acc; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",wrap:"App__wrap_1SQHV",base:"App__base_2Rw2G",link:"App__link_36M0v",active:"App__active_3QbdL"}},587:function(e,t,n){var o=n(588);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(36)(o,r);o.locals&&(e.exports=o.locals)},588:function(e,t,n){(t=e.exports=n(35)(!1)).push([e.i,"html,\nbody,\nmain {\n  width: 100%;\n  height: 100%; }\n\nbody {\n  margin: 0;\n  font-family: sans-serif; }\n  body.index__cursor-move_3IF2O * {\n    cursor: move; }\n\n.ReactCodeMirror {\n  height: 100%; }\n\n.CodeMirror {\n  height: 100%; }\n",""]),t.locals={"cursor-move":"index__cursor-move_3IF2O"}},591:function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"WIDTH",function(){return q}),n.d(o,"TYPE_VALUE",function(){return G}),n.d(o,"TYPE_FUNCTION",function(){return ee}),n.d(o,"TYPE_PROPERTY",function(){return te}),n.d(o,"TYPE_OPERATOR",function(){return ne}),n.d(o,"TYPE_VIEW",function(){return oe});var r={};n.r(r),n.d(r,"TYPE_OUTPUT",function(){return re}),n.d(r,"TYPE_INPUT",function(){return ie}),n.d(r,"RADIUS",function(){return ce}),n.d(r,"S_RADIUS",function(){return ae});var i=n(0),c=n.n(i),a=n(49),s=n.n(a),l=n(111),p=n.n(l),u=n(50),d=n.n(u),h=n(29),b=n.n(h),m=n(17),y=n(238),g=n.n(y),v=n(593),_=n(112),O=n.n(_),E=n(164),P=n.n(E);const k=(e,t,n,o)=>Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2)),f=e=>{const{type:t,changedTouches:n}=e;if(P()(["mousedown","mousemove","mouseup"],t))return e;if(P()(["touchstart","touchmove","touchend"],t))return n.item(0);throw new Error("Unknown event type")},T=new class e{static get ZEROS_42(){return"000000000000000000000000000000000000000000"}static get ZEROS_12(){return"000000000000"}constructor(){this.sequence=0,this.ptime=0}id(){const t=Date.now();t===this.ptime?this.sequence+=1:this.sequence=0;const n=(e.ZEROS_42+(t-1288834974657).toString(2)).slice(-42),o=(e.ZEROS_12+this.sequence.toString(2)).slice(-12);return O()(`${n}${o}`,2)}};var w,x=Object(v.a)({ADD_BLOCK:e=>g()({id:T.id()},e),UPDATE_BLOCK:(e,t)=>({id:e,patch:t}),DELTA_MOVE_BLOCK:(e,t,n)=>({id:e,dx:t,dy:n}),TOGGLE_BLOCK_CREATOR:(e,t)=>({x:e,y:t})},"DELETE_BLOCK","UPDATE_BLOCK_CREATOR","ADD_PIN","DELETE_PIN","START_POINT_LINK","END_POINT_LINK","ADD_PIN_LINK","REMOVE_PIN_LINK_BY_QUERY","ON_CHANGE_HTML","CLEAR_VIEW_BLOCK","PUSH_VIEW_BLOCK","SHOW_BLOCK_CREATOR"),D=n(3),C=n(239),M=n.n(C);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var L,U,I,j,B,N,Y,R,A=(L=(w=class extends i.Component{constructor(){super(),this.tab=!1,this.selectionStart=-1}componentDidUpdate(){const{selectionStart:e}=this;if(-1<e){const t=e+1;s.a.findDOMNode(this).setSelectionRange(t,t)}this.selectionStart=-1}onKeyDown(...e){const{props:{onKeyDown:t}}=this,{keyCode:n,currentTarget:{selectionStart:o}}=e[0];9===n&&(this.selectionStart=o),"function"==typeof t&&t(...e)}render(){const{props:e}=this,t=M()(e);return delete t.onKeyDown,c.a.createElement("textarea",S({},t,{onKeyDown:this.onKeyDown}))}}).prototype,U="onKeyDown",I=[D.a],j=Object.getOwnPropertyDescriptor(w.prototype,"onKeyDown"),B=w.prototype,N={},Object.keys(j).forEach(function(e){N[e]=j[e]}),N.enumerable=!!N.enumerable,N.configurable=!!N.configurable,("value"in N||N.initializer)&&(N.writable=!0),N=I.slice().reverse().reduce(function(e,t){return t(L,U,e)||e},N),B&&void 0!==N.initializer&&(N.value=N.initializer?N.initializer.call(B):void 0,N.initializer=void 0),void 0===N.initializer&&(Object.defineProperty(L,U,N),N=null),w);n(530);function z(e,t,n,o,r){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}window.ontouchmove=(()=>{});let K=Object(m.b)()((z((R=class extends i.Component{constructor(){super(),this.prevX=0,this.prevY=0}onChange(e){const{props:{model:t,dispatch:n}}=this;n(x.updateBlock(t.get("id"),{value:e.currentTarget.value}))}onClickDeleteButton(){const{props:{model:e,dispatch:t}}=this,n=e.get("id");t(x.deleteBlock(n))}onMouseDownOrTouchStart(e){const{target:{nodeName:t}}=e;if("DIV"===t){const{pageX:t,pageY:n}=f(e);this.prevX=t,this.prevY=n,document.body.classList.add("cursor-move"),document.addEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument)}}onMouseMoveOrTouchMoveDocument(e){const{pageX:t,pageY:n}=f(e),{props:{model:o,dispatch:r},prevX:i,prevY:c}=this;e.preventDefault(),r(x.deltaMoveBlock(o.get("id"),t-i,n-c)),this.prevX=t,this.prevY=n}onMouseUpOrTouchEndDocument(){document.body.classList.remove("cursor-move"),document.removeEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument)}addPin(){const{props:{model:e,dispatch:t}}=this;t(x.addPin(e.get("id")))}deletePin(){const{props:{model:e,dispatch:t}}=this;t(x.deletePin({id:e.get("id"),removed:e.get("inputPins").size-1}))}onKeyDown(e){const{keyCode:t,currentTarget:{selectionStart:n,selectionEnd:o}}=e,{props:{dispatch:r,model:i}}=this;if(9===t){e.preventDefault();const t=i.get("value");r(x.updateBlock(i.get("id"),{value:`${t.substring(0,n)}\t${t.substring(o)}`}))}}render(){const{props:{model:e}}=this,t=e.get("color");return c.a.createElement("div",{className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),height:e.get("height")}},c.a.createElement("div",null,e.get("deletable")?c.a.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,e.get("changeable")?c.a.createElement("button",{onClick:this.addPin},"+"):null,e.get("changeable")?c.a.createElement("button",{onClick:this.deletePin},"-"):null),c.a.createElement("div",{className:"Block__textarea-div_19vCU"},c.a.createElement(A,{readOnly:!e.get("editable"),onChange:this.onChange,value:e.get("value"),spellCheck:!1,style:{borderLeft:`5px solid ${t}`},onKeyDown:this.onKeyDown})))}}).prototype,"onChange",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"onChange"),R.prototype),z(R.prototype,"onClickDeleteButton",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"onClickDeleteButton"),R.prototype),z(R.prototype,"onMouseDownOrTouchStart",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"onMouseDownOrTouchStart"),R.prototype),z(R.prototype,"onMouseMoveOrTouchMoveDocument",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"onMouseMoveOrTouchMoveDocument"),R.prototype),z(R.prototype,"onMouseUpOrTouchEndDocument",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"onMouseUpOrTouchEndDocument"),R.prototype),z(R.prototype,"addPin",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"addPin"),R.prototype),z(R.prototype,"deletePin",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"deletePin"),R.prototype),z(R.prototype,"onKeyDown",[D.a],Object.getOwnPropertyDescriptor(R.prototype,"onKeyDown"),R.prototype),Y=R))||Y;var V=n(240),$=n.n(V),W=n(241),H=n.n(W),F=n(162),Z=n.n(F),X=n(52),J=n.n(X);const{blockWidth:Q}=J.a,q=O()(Q),G="VALUE_BLOCK",ee="FUNCTION_BLOCK",te="PROPERTY_BLOCK",ne="OPERATOR_BLCOK",oe="VIEW_BLOCK",re="OUTPUT_PIN",ie="INPUT_PIN",ce=7,ae=4;var se,le,pe=n(65);n(550);function ue(e,t,n,o,r){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}const de=[o.TYPE_VALUE,o.TYPE_FUNCTION,o.TYPE_PROPERTY,o.TYPE_OPERATOR],he=b()(de,e=>Z()(H()(e)));let be=Object(m.b)()((ue((le=class extends i.Component{componentWillUpdate(e){const{model:t}=e,{props:{model:n}}=this;!n.get("visible")&&t.get("visible")&&(document.addEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.addEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}onClick(){const{props:{model:e,dispatch:t}}=this;document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument),t(Object(pe.batchActions)([x.addBlock({x:e.get("x"),y:e.get("y"),value:$()(e.get("value")),type:e.get("selected")}),x.updateBlockCreator({visible:!1})]))}onChangeTextarea(e){const{currentTarget:{value:t}}=e,{props:{dispatch:n}}=this;n(x.updateBlockCreator({value:t}))}onChangeSelect(e){const{currentTarget:{value:t}}=e,{props:{dispatch:n}}=this;n(x.updateBlockCreator({selected:t}))}onMouseDownOrTouchStartDocument(e){const{target:t}=e,{props:{dispatch:n}}=this,o=Object(a.findDOMNode)(this);o&&!o.contains(t)&&(n(x.updateBlockCreator({visible:!1})),document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}onKeyDown(e){const{keyCode:t,currentTarget:{selectionStart:n,selectionEnd:o}}=e,{props:{dispatch:r,model:i}}=this;if(9===t){e.preventDefault();const t=i.get("value");r(x.updateBlockCreator({value:`${t.substring(0,n)}\t${t.substring(o)}`}))}}render(){const{props:{model:e}}=this;return e.get("visible")?c.a.createElement("div",{className:"BlockCreator__base_1ZSFp",style:{position:"absolute",left:e.get("x"),top:e.get("y")}},c.a.createElement("select",{value:e.get("selected"),onChange:this.onChangeSelect},b()(de,(e,t)=>c.a.createElement("option",{value:e,key:t},he[t]))),c.a.createElement(A,{onChange:this.onChangeTextarea,value:e.get("value"),spellCheck:!1,onKeyDown:this.onKeyDown}),c.a.createElement("button",{onClick:this.onClick},"ADD")):null}}).prototype,"onClick",[D.a],Object.getOwnPropertyDescriptor(le.prototype,"onClick"),le.prototype),ue(le.prototype,"onChangeTextarea",[D.a],Object.getOwnPropertyDescriptor(le.prototype,"onChangeTextarea"),le.prototype),ue(le.prototype,"onChangeSelect",[D.a],Object.getOwnPropertyDescriptor(le.prototype,"onChangeSelect"),le.prototype),ue(le.prototype,"onMouseDownOrTouchStartDocument",[D.a],Object.getOwnPropertyDescriptor(le.prototype,"onMouseDownOrTouchStartDocument"),le.prototype),ue(le.prototype,"onKeyDown",[D.a],Object.getOwnPropertyDescriptor(le.prototype,"onKeyDown"),le.prototype),se=le))||se;const{white0:me}=J.a;var ye=e=>{const{points:t,strokeDasharray:n}=e;return c.a.createElement("polyline",{points:((e,t,n,o,r=10)=>{const i=k(e,t,n,o);if(0===i)return[];const c=(n-e)/i,a=o-t,s=[];for(let l=0;l<=i;l+=1){const p=e+c*l,u=t+a*(1-Math.cos(Math.PI/i*l))/2;r<k(e,t,p,u)&&r<k(n,o,p,u)&&s.push(p,u)}return s})(...t),fill:"none",stroke:me,strokeWidth:3,strokeDasharray:n})};var ge,ve=e=>{const{model:t}=e;return c.a.createElement(ye,{points:t.points(),strokeDasharray:[5,5]})};let _e=Object(m.b)(({blocks:e})=>({blocks:e}))(ge=class extends i.Component{render(){const{props:{blocks:e,model:t}}=this,n=[];return d()(["output","input"],o=>{const r=e.find(e=>e.get("id")===t.getIn([o,"block"])).getIn([`${o}Pins`,t.getIn([o,"pin"])]);n.push(r.get("cx"),r.get("cy"))}),c.a.createElement(ye,{points:n})}})||ge;var Oe,Ee=n(242),Pe=n.n(Ee),ke=n(45),fe=n.n(ke),Te=n(76),we=n.n(Te);function xe(e,t,n,o,r){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}const De=r.RADIUS+1;let Ce=(xe((Oe=class extends i.Component{constructor(){super(),this.state={enter:!1,connecting:!1}}onMouseDownOrTouchStart(e){const{props:{model:t,parent:n,onMouseDownOrTouchStart:o}}=this;o(e,t,n),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!0})}onMouseup(e){const{props:{model:t,onMouseUpOrTouchEnd:n,parent:o}}=this;n(e,t,o)}onMouseEnter(){this.setState({enter:!0})}onMouseLeave(){this.setState({enter:!1})}onTouchEnd(e){const{pageX:t,pageY:n}=e.changedTouches.item(0);we()(document.querySelectorAll("[data-pin]"),o=>{const{left:r,top:i,width:c,height:a}=o.getBoundingClientRect();return r<=t&&t<=r+c&&i<=n&&n<=i+a&&(we()(fe()(o),t=>{if(Pe()(t,"__reactInternalInstance$")){const{_currentElement:{_owner:{_currentElement:{props:{model:n,onMouseUpOrTouchEnd:r,parent:i}}}}}=o[t];return r(e,n,i),!0}return!1}),!0)})}onMouseUpOrTouchEndDocument(){document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!1})}render(){const{props:{model:e},state:{enter:t,connecting:n}}=this,o=e.get("color"),i=e.get("type");return c.a.createElement("svg",{"data-pin":!0,onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,onMouseUp:this.onMouseup,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onTouchEnd:this.onTouchEnd,style:{position:"absolute",left:e.get("cx")-De,top:e.get("cy")-De,width:2*r.RADIUS+2,height:2*r.RADIUS+2,cursor:"pointer"}},c.a.createElement("circle",{cx:De,cy:De,r:r.S_RADIUS,fill:i===r.TYPE_INPUT?"none":i===r.TYPE_OUTPUT?o:"red",stroke:o}),t||n||e.get("linked")?c.a.createElement("circle",{cx:De,cy:De,r:r.RADIUS,fill:"none",stroke:o}):null)}}).prototype,"onMouseDownOrTouchStart",[D.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onMouseDownOrTouchStart"),Oe.prototype),xe(Oe.prototype,"onMouseup",[D.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onMouseup"),Oe.prototype),xe(Oe.prototype,"onMouseEnter",[D.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onMouseEnter"),Oe.prototype),xe(Oe.prototype,"onMouseLeave",[D.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onMouseLeave"),Oe.prototype),xe(Oe.prototype,"onTouchEnd",[D.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onTouchEnd"),Oe.prototype),xe(Oe.prototype,"onMouseUpOrTouchEndDocument",[D.a],Object.getOwnPropertyDescriptor(Oe.prototype,"onMouseUpOrTouchEndDocument"),Oe.prototype),Oe);var Me,Se,Le=n(86);n(563);function Ue(e,t,n,o,r){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}window.ontouchmove=(()=>{});let Ie=Object(m.b)(({blocks:e,pointLink:t,pinLinks:n,blockCreator:o})=>({blocks:e,link:t,links:n,blockCreator:o}))((Ue((Se=class e extends i.Component{static convertPinTypeToPinLinkKey(e){switch(e){case r.TYPE_OUTPUT:return"output";case r.TYPE_INPUT:return"input";default:throw new Error("Unknown pin type")}}componentDidMount(){window.addEventListener("message",this.onMessage)}componentWillReceiveProps(e){const{blocks:t,links:n}=e;localStorage.setItem("storedState",JSON.stringify({blocks:t.toJS(),links:n.toJS()}))}componentWillUnmount(){window.removeEventListener("message",this.onMessage)}onConnectStart(e,t,n){const{props:{dispatch:o}}=this,i=t.get("type"),c=t.get("index"),a=[x.startPointLink({x:t.get("cx"),y:t.get("cy")})];document.addEventListener("mousemove",this.onConnecting),document.addEventListener("mouseup",this.onConnectEnd),document.addEventListener("touchmove",this.onConnecting),document.addEventListener("touchend",this.onConnectEnd),window.__connection__={block:n,pin:c,pinType:i},i===r.TYPE_INPUT&&a.push(x.removePinLinkByQuery({input:{block:n,pin:c}})),o(Object(pe.batchActions)(a))}onConnecting(e){const{props:{dispatch:t}}=this,{clientX:n,clientY:o}=f(e);e.preventDefault(),t(x.endPointLink({x:n,y:o}))}onConnectEnd(){const{props:{dispatch:e}}=this;e(x.startPointLink({x:0,y:0})),document.removeEventListener("mousemove",this.onConnecting),document.removeEventListener("mouseup",this.onConnectEnd),document.removeEventListener("touchmove",this.onConnecting),document.removeEventListener("touchend",this.onConnectEnd)}onConnectPin(t,n,o){const{__connection__:{block:r,pin:i,pinType:c}}=window,{props:{dispatch:a}}=this,s=n.get("index"),l=n.get("type");r!==o&&c!==l&&a(x.addPinLink({[e.convertPinTypeToPinLinkKey(c)]:{block:r,pin:i},[e.convertPinTypeToPinLinkKey(l)]:{block:o,pin:s}}))}onMessage(e){const{props:{dispatch:t}}=this,{data:{type:n,value:o}}=e;"chain-result"===n?t(x.pushViewBlock(JSON.stringify(o))):"chain-error"===n?Le.toast.error(o,{position:Le.toast.POSITION.BOTTOM_RIGHT}):"chain-clear"===n&&t(x.clearViewBlock())}onMouseDownOrTouchStart(e){const{target:t,currentTarget:n}=e,{clientX:o,clientY:r}=f(e),{props:{dispatch:i}}=this;t===n&&i(x.showBlockCreator({x:o,y:r}))}render(){const{props:{link:e,links:t,blockCreator:n}}=this;let{props:{blocks:o}}=this;return c.a.createElement("div",{className:"Chain__base_L0Lag"},c.a.createElement("svg",{onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart},t.map((e,t)=>(d()(["input","output"],t=>{const n=o.findIndex(n=>n.get("id")===e.getIn([t,"block"]));o=o.setIn([n,`${t}Pins`,e.getIn([t,"pin"]),"linked"],!0)}),c.a.createElement(_e,{key:t,model:e}))),c.a.createElement(ve,{model:e})),o.map(e=>{const t=e.get("id");return[c.a.createElement(K,{key:t,model:e}),e.get("inputPins").map(e=>c.a.createElement(Ce,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin})),e.get("outputPins").map(e=>c.a.createElement(Ce,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin}))]}),c.a.createElement(be,{model:n}))}}).prototype,"onConnectStart",[D.a],Object.getOwnPropertyDescriptor(Se.prototype,"onConnectStart"),Se.prototype),Ue(Se.prototype,"onConnecting",[D.a],Object.getOwnPropertyDescriptor(Se.prototype,"onConnecting"),Se.prototype),Ue(Se.prototype,"onConnectEnd",[D.a],Object.getOwnPropertyDescriptor(Se.prototype,"onConnectEnd"),Se.prototype),Ue(Se.prototype,"onConnectPin",[D.a],Object.getOwnPropertyDescriptor(Se.prototype,"onConnectPin"),Se.prototype),Ue(Se.prototype,"onMessage",[D.a],Object.getOwnPropertyDescriptor(Se.prototype,"onMessage"),Se.prototype),Ue(Se.prototype,"onMouseDownOrTouchStart",[D.a],Object.getOwnPropertyDescriptor(Se.prototype,"onMouseDownOrTouchStart"),Se.prototype),Me=Se))||Me;var je=n(74),Be=n(11),Ne=n(243),Ye=n.n(Ne),Re=n(24),Ae=n.n(Re),ze=n(244),Ke=n.n(ze);const{white0:Ve,purple0:$e,blue1:We,yellow0:He}=J.a;class Fe extends(Object(Be.c)({id:0,value:"",x:0,y:0,deletable:!0,editable:!0,type:"",color:Ve,changeable:!0,outputPins:Object(Be.a)(),inputPins:Object(Be.a)(),height:70})){constructor(e){super(e);const{type:t}=this;let n=null;switch(t){case o.TYPE_VIEW:n={editable:!1,deletable:!1,color:$e,inputPins:this._createPins([Ve],r.TYPE_INPUT)};break;case o.TYPE_VALUE:n={changeable:!1,outputPins:this._createPins([$e],r.TYPE_OUTPUT)};break;case o.TYPE_FUNCTION:n={color:We,inputPins:this._createPins([We],r.TYPE_INPUT),outputPins:this._createPins([$e],r.TYPE_OUTPUT)};break;case o.TYPE_PROPERTY:n={changeable:!1,color:He,inputPins:this._createPins([Ve],r.TYPE_INPUT),outputPins:this._createPins([Ve],r.TYPE_OUTPUT)};break;case o.TYPE_OPERATOR:n={changeable:!1,inputPins:this._createPins([Ve,Ve],r.TYPE_INPUT),outputPins:this._createPins([Ve],r.TYPE_OUTPUT)};break;default:throw new Error(`Unknown type: ${t}.`)}return this.merge(n).recalculateHeight()}recalculateHeight(){const{inputPins:{size:e},outputPins:{size:t}}=this;return this.set("height",Math.max(4,e+1,t+1)*(2*r.RADIUS+3)-1)}dmove(e,t){const{x:n,y:o,inputPins:r,outputPins:i}=this;return this.merge({x:n+e,y:o+t,inputPins:r.map(n=>n.dmove(e,t)),outputPins:i.map(n=>n.dmove(e,t))})}createPin(e,t,n=null){const{x:o,y:r}=this,i=Fe.convertPinTypeToPinKey(t),{size:c}=this.get(i),a=Ke()(n)?c:n,[s,l]=Fe._pinPosition(a,t);return new Ze({index:a,color:e,type:t,cx:o+s,cy:r+l})}_createPins(e,t){const n=this.get(Fe.convertPinTypeToPinKey(t));return 0===n.size?Object(Be.a)(b()(e,(e,n)=>this.createPin(e,t,n))):n}static convertPinTypeToPinKey(e){switch(e){case r.TYPE_OUTPUT:return"outputPins";case r.TYPE_INPUT:return"inputPins";default:throw new Error("Unknown pin type")}}static _pinPosition(e,t){return[t===r.TYPE_INPUT?-r.RADIUS-2:t===r.TYPE_OUTPUT?o.WIDTH+r.RADIUS:0,r.RADIUS+(2*r.RADIUS+3)*e+1]}}class Ze extends(Object(Be.c)({index:0,color:Ve,type:"",linked:!1,cx:0,cy:0})){dmove(e,t){const{cx:n,cy:o}=this;return this.merge({cx:n+e,cy:o+t})}}class Xe extends(Object(Be.c)({output:Object(Be.b)({block:0,pin:0}),input:Object(Be.b)({block:0,pin:0})})){constructor(e){d()(["output","input"],t=>{p()(e,t)&&(e[t]=Object(Be.b)(e[t]))}),super(e)}hasBlock(e){return we()(["output","input"],t=>this.getIn([t,"block"])===e)}match({output:e,input:t}){return Xe._matcher(this.get("output"),e)&&Xe._matcher(this.get("input"),t)}static _matcher(e,t){return Ae()(t)?!we()(Ye()(t),([t,n])=>!Xe._matcher(e.get(t),n)):void 0!==e&&(void 0===t||e===t)}}var Je=n(594);const{blue2:Qe,white0:qe}=J.a;var Ge,et=Object(Je.a)({[x.addBlock]:(e,t)=>{const{payload:n}=t;return e.push(new Fe(n))},[x.updateBlock]:(e,t)=>{const{payload:{id:n,patch:o}}=t,r=e.findIndex(e=>e.get("id")===n);return e.update(r,e=>e.merge(o))},[x.deleteBlock]:(e,t)=>{const{payload:n}=t,o=e.findIndex(e=>e.get("id")===n);return e.filter((e,t)=>t!==o)},[x.deltaMoveBlock]:(e,t)=>{const{payload:{id:n,dx:o,dy:r}}=t,i=e.findIndex(e=>e.get("id")===n);return e.update(i,e=>e.dmove(o,r))},[x.addPin]:(e,t)=>{const{payload:n}=t,i=e.findIndex(e=>e.get("id")===n);return e.update(i,e=>e.updateIn(["inputPins"],t=>t.push(e.createPin(e.type===o.TYPE_FUNCTION?Qe:qe,r.TYPE_INPUT))).recalculateHeight())},[x.deletePin]:(e,t)=>{const{payload:{id:n}}=t,o=e.findIndex(e=>e.get("id")===n);return e.update(o,e=>e.updateIn(["inputPins"],e=>e.slice(0,Math.max(1,e.size-1))).recalculateHeight())},[x.clearViewBlock]:e=>e.update(0,e=>e.set("value","")),[x.pushViewBlock]:(e,t)=>{const{payload:n}=t;return e.update(0,e=>{const t=e.get("value");return e.set("value",t?`${t}\n${n}`:n)})}},Object(Be.a)()),tt=Object(Je.a)({[x.updateBlockCreator]:(e,t)=>{const{payload:n}=t;return e.merge(n)},[x.showBlockCreator]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.show(n,o)}},new class extends(Object(Be.c)({x:0,y:0,visible:!1,value:"",selected:o.TYPE_VALUE})){show(e,t){return this.merge({visible:!0,x:e,y:t,value:"",selected:o.TYPE_VALUE})}}),nt=Object(Je.a)({[x.startPointLink]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.start(n,o)},[x.endPointLink]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.end(n,o)}},new class extends(Object(Be.c)({ax:0,ay:0,bx:0,by:0})){start(e,t){return this.merge({ax:e,ay:t,bx:e,by:t})}end(e,t){return this.merge({bx:e,by:t})}points(){const{ax:e,ay:t,bx:n,by:o}=this;return[e,t,n,o]}}),ot=Object(Je.a)({[x.addPinLink]:(e,t)=>{const{payload:n}=t,o={input:n.input};return e.filter(e=>!e.match(o)).push(new Xe(n))},[x.deleteBlock]:(e,t)=>{const{payload:n}=t;return e.filter(e=>!e.hasBlock(n))},[x.removePinLinkByQuery]:(e,t)=>{const{payload:n}=t;return e.filter(e=>!e.match(n))},[x.deletePin]:(e,t)=>{const{payload:{id:n,removed:o}}=t;return 0===o?e:e.filter(e=>!e.match({input:{block:n,pin:o}}))}},Object(Be.a)()),rt=Object(Je.a)({[x.onChangeHtml]:(e,t)=>{const{payload:n}=t;return n}},'<!doctype html>\n<html>\n<head>\n\t<meta charset="utf-8" />\n</head>\n<body>\n\t<h1>Hello, World!</h1>\n</body>\n</html>\n'),it=Object(je.b)({blocks:et,blockCreator:tt,pointLink:nt,pinLinks:ot,htmlEditor:rt}),ct=n(595),at=n(596),st=n(247),lt=n(597),pt=n(166),ut=n.n(pt);n(568);const dt=new DOMParser;let ht=Object(m.b)(({blocks:e,pinLinks:t,htmlEditor:n})=>({blocks:e,links:t,html:n}))(Ge=class extends i.Component{toEvalableString(){const{props:{blocks:e}}=this,t=e.first();return t?this.toEvalableStringSub(t.get("id")):null}toEvalableStringSub(e){if(null===e)return"null";const{props:{blocks:t}}=this,n=t.find(t=>t.get("id")===e),r=n.get("inputPins").map(t=>this.toEvalableStringSub(this.findOutputBlockIdFromLinks({input:{block:e,pin:t.get("index")}}))).toJS();switch(n.get("type")){case o.TYPE_VIEW:return r;case o.TYPE_VALUE:return n.get("value");case o.TYPE_FUNCTION:const[e,...t]=r,i=`(${ut()(t,", ")})`;return e?`${e}[${JSON.stringify(n.get("value"))}]${i}`:`${n.get("value")}${i}`;case o.TYPE_PROPERTY:return`${r[0]}[${JSON.stringify(n.get("value"))}]`;case o.TYPE_OPERATOR:return`(${r[0]}${n.get("value")}${r[1]})`;default:return'"UNKNOWN_BLOCK"'}}findOutputBlockIdFromLinks(e){const{props:{links:t}}=this;let n=null;return t.some(t=>!!t.match(e)&&(n=t.getIn(["output","block"]),!0)),n}render(){const{props:{html:e}}=this,t=dt.parseFromString(e,"text/html"),n=t.querySelector("body"),o=document.createElement("script"),r=ut()(b()(this.toEvalableString(),e=>`parent.postMessage({ type: 'chain-result', value: ${e} }, '*')`),"\n");return o.innerHTML=`\n\t\t\tparent.postMessage({ type: 'chain-clear' }, '*');\n\t\t\ttry {\n\t\t\t\t(0, eval)(${JSON.stringify(r)});\n\t\t\t} catch (err) {\n\t\t\t\tparent.postMessage({ type: 'chain-error', value: String(err) }, '*');\n\t\t\t}\n\t\t`,n.appendChild(o),c.a.createElement("iframe",{srcDoc:`<!doctype html>${t.documentElement.outerHTML}`,className:"HTMLRenderer__base_y4ZXu"})}})||Ge;var bt,mt,yt=n(245),gt=n.n(yt);n(576),n(578),n(580),n(584);let vt=Object(m.b)(({htmlEditor:e})=>({code:e}))((function(e,t,n,o,r){var i={};Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null)}((mt=class extends i.Component{onChange(e){const{props:{dispatch:t}}=this;t(x.onChangeHtml(e))}render(){const{props:{code:e}}=this;return c.a.createElement(gt.a,{value:e,onChange:this.onChange,options:{mode:"htmlmixed",theme:"monokai",styleActiveLine:!0,lineNumbers:!0}})}}).prototype,"onChange",[D.a],Object.getOwnPropertyDescriptor(mt.prototype,"onChange"),mt.prototype),bt=mt))||bt;var _t=n(246),Ot=n.n(_t);const{link:Et,active:Pt}=Ot.a,kt=Object(je.c)(Object(pe.enableBatching)(it)),ft=JSON.parse(localStorage.getItem("storedState"));if(ft){const{blocks:e,links:t}=ft,{length:n}=e;n>0?kt.dispatch(Object(pe.batchActions)([...b()(e,e=>(d()(["inputPins","outputPins"],t=>{p()(e,t)&&(e[t]=Object(Be.a)(b()(e[t],e=>new Ze(e))))}),x.addBlock(e))),...b()(t,e=>x.addPinLink(e))])):kt.dispatch(x.addBlock({x:100,y:100,type:o.TYPE_VIEW}))}else kt.dispatch(x.addBlock({x:100,y:100,type:o.TYPE_VIEW}));const Tt=()=>c.a.createElement(ct.a,{to:"/chain"});var wt=class extends i.Component{render(){return c.a.createElement(m.a,{store:kt},c.a.createElement(at.a,null,c.a.createElement("div",{className:"App__wrap_1SQHV"},c.a.createElement("div",{className:"App__base_2Rw2G"},c.a.createElement(ht,null),c.a.createElement(st.a,{exact:!0,path:"/",render:Tt}),c.a.createElement(st.a,{path:"/chain",component:Ie}),c.a.createElement(st.a,{path:"/editor",component:vt})),c.a.createElement("footer",null,c.a.createElement(lt.a,{to:"/chain",className:Et,activeClassName:Pt},c.a.createElement("span",null,"Chain")),c.a.createElement(lt.a,{to:"/editor",className:Et,activeClassName:Pt},c.a.createElement("span",null,"Editor")),c.a.createElement(lt.a,{to:"/view",className:Et,activeClassName:Pt},c.a.createElement("span",null,"View"))),c.a.createElement(Le.ToastContainer,{autoClose:3e3}))))}};n(587),n(589);Object(a.render)(c.a.createElement(wt,null),document.querySelector("main"))}});